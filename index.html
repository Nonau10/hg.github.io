<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chronologie de la Révolution Française - Le Jeu</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .dragging {
            opacity: 0.5;
            background-color: #c7d2fe;
            border: 2px dashed #4f46e5;
        }
        .drag-over {
            transform: scale(1.02);
            background-color: #e0e7ff;
        }
        .event-card {
            touch-action: none;
        }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen p-4">

    <div class="bg-white rounded-2xl shadow-xl p-6 md:p-8 max-w-2xl w-full mx-auto">
        <div class="text-center mb-6">
            <h1 class="text-3xl font-bold text-gray-800">La Révolution en Ordre !</h1>
            <p class="text-gray-600 mt-2">Glissez et déposez les événements ci-dessous pour les remettre dans l'ordre chronologique.</p>
        </div>

        <!-- Zone pour les événements à trier -->
        <ul id="timeline" class="space-y-3 mb-6">
            <!-- Les événements seront injectés ici par JavaScript -->
        </ul>

        <!-- Boutons d'action -->
        <div class="flex flex-col sm:flex-row gap-4">
            <button id="check-button" class="w-full bg-indigo-600 text-white font-semibold py-3 px-6 rounded-lg shadow-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-transform transform hover:scale-105">
                Vérifier ma réponse
            </button>
            <button id="reset-button" class="w-full bg-gray-200 text-gray-700 font-semibold py-3 px-6 rounded-lg hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-offset-2 transition-transform transform hover:scale-105">
                Rejouer
            </button>
        </div>

        <!-- Zone de message pour les résultats -->
        <div id="result-message" class="mt-6 text-center text-lg font-medium p-4 rounded-lg hidden"></div>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Données des événements
            const events = [
                { date: "1788-08-08", title: "Convocation des états généraux", description: "Le roi Louis XVI convoque les états généraux face à la crise financière." },
                { date: "1789-05-05", title: "Ouverture des états généraux", description: "Réunion des trois ordres à Versailles et début des blocages sur la question du vote." },
                { date: "1789-06-20", title: "Serment du Jeu de paume", description: "Les députés du tiers état jurent de donner une Constitution à la France." },
                { date: "1789-07-14", title: "Prise de la Bastille", description: "Le peuple parisien prend d'assaut la forteresse, symbole du pouvoir royal." },
                { date: "1789-08-04", title: "Abolition des privilèges", description: "L'Assemblée vote la fin des droits féodaux, de la noblesse et du clergé." },
                { date: "1789-08-26", title: "Déclaration des Droits de l'Homme et du Citoyen", description: "Adoption du texte fondamental énonçant les principes de liberté et d'égalité." },
                { date: "1790-07-12", title: "Constitution civile du clergé", description: "L'Église de France est réorganisée, créant une division profonde dans le pays." },
                { date: "1791-06-20", title: "Fuite du roi à Varennes", description: "La tentative de fuite du roi brise la confiance entre le monarque et la Révolution." },
                { date: "1791-09-03", title: "Première Constitution française", description: "La France devient une monarchie constitutionnelle." },
                { date: "1792-06-20", title: "Invasion des Tuileries par les sans-culottes", description: "Le peuple envahit le palais pour protester contre les vetos du roi." },
                { date: "1792-08-10", title: "Prise des Tuileries et chute de la monarchie", description: "Une insurrection populaire renverse la royauté." },
                { date: "1792-09-21", title: "Proclamation de la République", description: "La Convention nationale abolit la royauté et proclame la Première République." },
                { date: "1793-04-06", title: "Création du Comité de salut public", description: "Création d'un comité aux pouvoirs étendus pour faire face aux dangers menaçant la République." },
                { date: "1793-09-05", title: "Début de la Terreur", description: "Le Comité de salut public met \"la Terreur à l'ordre du jour\" pour écraser les opposants." },
                { date: "1794-07-27", title: "Chute de Robespierre (9 Thermidor)", description: "La Convention se retourne contre Robespierre, marquant la fin de la Terreur." }
            ];

            const timeline = document.getElementById('timeline');
            const checkButton = document.getElementById('check-button');
            const resetButton = document.getElementById('reset-button');
            const resultMessage = document.getElementById('result-message');

            let draggedItem = null;

            // Fonction pour mélanger et afficher les événements
            function setupGame() {
                timeline.innerHTML = '';
                resultMessage.classList.add('hidden');
                resultMessage.textContent = '';
                checkButton.disabled = false;

                const shuffledEvents = [...events].sort(() => Math.random() - 0.5);
                
                shuffledEvents.forEach(event => {
                    const li = document.createElement('li');
                    li.classList.add('event-card', 'bg-gray-50', 'p-4', 'rounded-lg', 'shadow-sm', 'cursor-grab', 'border-l-4', 'border-indigo-300', 'flex', 'items-center', 'gap-4', 'transition-all', 'duration-300');
                    li.setAttribute('draggable', true);
                    li.dataset.date = event.date;

                    li.innerHTML = `
                        <div class="text-indigo-600 font-bold text-xl">≡</div>
                        <div>
                            <h3 class="font-semibold text-gray-800">${event.title}</h3>
                            <p class="text-sm text-gray-500">${event.description}</p>
                        </div>
                    `;
                    timeline.appendChild(li);
                });

                addDragListeners();
            }

            // Ajout des écouteurs d'événements pour le glisser-déposer
            function addDragListeners() {
                const items = timeline.querySelectorAll('.event-card');

                items.forEach(item => {
                    item.addEventListener('dragstart', handleDragStart);
                    item.addEventListener('dragend', handleDragEnd);

                    // Pour les appareils tactiles
                    item.addEventListener('touchstart', handleTouchStart, { passive: false });
                    item.addEventListener('touchmove', handleTouchMove, { passive: false });
                    item.addEventListener('touchend', handleTouchEnd);
                });

                timeline.addEventListener('dragover', handleDragOver);
                timeline.addEventListener('drop', handleDrop);
            }

            // Gestionnaires d'événements Drag & Drop
            function handleDragStart(e) {
                draggedItem = this;
                e.dataTransfer.effectAllowed = 'move';
                e.dataTransfer.setData('text/html', this.innerHTML);
                setTimeout(() => {
                    this.classList.add('dragging');
                }, 0);
            }

            function handleDragEnd() {
                this.classList.remove('dragging');
                document.querySelectorAll('.drag-over').forEach(el => el.classList.remove('drag-over'));
            }

            function handleDragOver(e) {
                e.preventDefault();
                const afterElement = getDragAfterElement(timeline, e.clientY);
                document.querySelectorAll('.drag-over').forEach(el => el.classList.remove('drag-over'));
                if (afterElement) {
                    afterElement.classList.add('drag-over');
                }
            }

            function handleDrop(e) {
                e.preventDefault();
                const afterElement = getDragAfterElement(timeline, e.clientY);
                if (afterElement == null) {
                    timeline.appendChild(draggedItem);
                } else {
                    timeline.insertBefore(draggedItem, afterElement);
                }
                document.querySelectorAll('.drag-over').forEach(el => el.classList.remove('drag-over'));
            }

            // Logique tactile
            let touchStartY = 0;

            function handleTouchStart(e) {
                draggedItem = this;
                touchStartY = e.touches[0].clientY;
                this.classList.add('dragging');
                e.preventDefault();
            }

            function handleTouchMove(e) {
                if (!draggedItem) return;
                e.preventDefault();
                const touchY = e.touches[0].clientY;
                const afterElement = getDragAfterElement(timeline, touchY);
                document.querySelectorAll('.drag-over').forEach(el => el.classList.remove('drag-over'));
                if (afterElement) {
                   afterElement.classList.add('drag-over');
                   timeline.insertBefore(draggedItem, afterElement);
                } else {
                   timeline.appendChild(draggedItem);
                }
            }
            
            function handleTouchEnd() {
                if (!draggedItem) return;
                draggedItem.classList.remove('dragging');
                document.querySelectorAll('.drag-over').forEach(el => el.classList.remove('drag-over'));
                draggedItem = null;
            }


            function getDragAfterElement(container, y) {
                const draggableElements = [...container.querySelectorAll('.event-card:not(.dragging)')];

                return draggableElements.reduce((closest, child) => {
                    const box = child.getBoundingClientRect();
                    const offset = y - box.top - box.height / 2;
                    if (offset < 0 && offset > closest.offset) {
                        return { offset: offset, element: child };
                    } else {
                        return closest;
                    }
                }, { offset: Number.NEGATIVE_INFINITY }).element;
            }
            
            // Fonction pour vérifier la réponse
            function checkOrder() {
                const userOrder = [...timeline.querySelectorAll('.event-card')].map(li => li.dataset.date);
                const correctOrder = events.map(event => event.date).sort();

                let isCorrect = true;
                for (let i = 0; i < userOrder.length; i++) {
                    if (userOrder[i] !== correctOrder[i]) {
                        isCorrect = false;
                        break;
                    }
                }

                resultMessage.classList.remove('hidden', 'bg-green-100', 'text-green-800', 'bg-red-100', 'text-red-800');
                if (isCorrect) {
                    resultMessage.textContent = 'Félicitations ! Vous avez tout mis dans le bon ordre !';
                    resultMessage.classList.add('bg-green-100', 'text-green-800');
                    checkButton.disabled = true;
                } else {
                    resultMessage.textContent = 'Ce n\'est pas tout à fait ça. Essayez encore !';
                    resultMessage.classList.add('bg-red-100', 'text-red-800');
                }
            }

            checkButton.addEventListener('click', checkOrder);
            resetButton.addEventListener('click', setupGame);

            // Lancer le jeu au chargement
            setupGame();
        });
    </script>
</body>

</html>
